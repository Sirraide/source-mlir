/// R %srcc --hlir %s

/// d t %[a-zA-Z0-9_]+
/// d b \^bb[0-9]+

/// * func.func private @trivial
/// + (?<C1>$t) = arith.constant 4
/// + return $C1
proc trivial -> int { return 4; }

/// * func.func private @abbr
/// + (?<C2>$t) = arith.constant 4
/// + return $C2
proc abbr = 4;

/// * func.func private @abbr2
/// + (?<C3>$t) = arith.constant 4
/// + return $C3
proc abbr2 -> int = 4;

/// * func.func private @if_nested
proc if_nested (bool a) -> int {
    /// * (?<A1>$t) = hlir.load
    /// + cf.cond_br $A1, (?<TRUE_1>$b), (?<FALSE_1>$b)
    /// + $TRUE_1:
    /// + (?<C4>$t) = arith.constant 42
    /// + return $C4
    if a { return 42; }

    /// + $FALSE_1:
    /// + (?<A2>$t) = hlir.load
    /// + cf.cond_br $A2, (?<TRUE_2>$b), (?<FALSE_2>$b)
    /// + $TRUE_2:
    elif a {
        /// + (?<A3>$t) = hlir.load
        /// + cf.cond_br $A3, (?<TRUE_3>$b), (?<FALSE_3>$b)
        /// + $TRUE_3:
        /// + (?<C5>$t) = arith.constant 43
        /// + return $C5
        /// + $FALSE_3:
        /// + (?<C6>$t) = arith.constant 3
        /// + return $C6
        if a return 43;
        else return 3;
    }

    /// + $FALSE_2:
    else {
        /// + (?<A4>$t) = hlir.load
        /// + cf.cond_br $A4, (?<TRUE_4>$b), (?<FALSE_4>$b)
        /// + $TRUE_4:
        /// + (?<C7>$t) = arith.constant 5
        /// + return $C7
        if a return 5;

        /// + $FALSE_4:
        /// + (?<A5>$t) = hlir.load
        /// + cf.cond_br $A5, (?<TRUE_5>$b), (?<FALSE_5>$b)
        /// + $TRUE_5:
        /// + cf.br (?<JOIN_1>$b)
        elif a {}

        /// + $FALSE_5:
        /// + (?<C8>$t) = arith.constant 46
        /// + return $C8
        else return 46;

        /// Note that we end up with two join blocks here because
        /// `elif` is actually just `else { if ... }`, so we have
        /// a nested if and thus two join blocks.
        ///
        /// + $JOIN_1:
        /// + cf.br (?<JOIN_2>$b)
        /// + $JOIN_2:
        /// + (?<C9>$t) = arith.constant 6
        /// + return $C9
        return 6;
    }
}